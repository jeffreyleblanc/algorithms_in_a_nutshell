<html lang="en"> 
<head> 
    <meta charset="utf-8" />
    <meta name="viewport" content="user-scalable=no, width=1000" />
    <title>Algorithims : nutshell</title>
     
	<!-- Wickk src links -->
	<script src="dep/wickk-0.1-dependencies.js"></script>
	<script src="dep/wickk-0.1.min.js"></script>
	<link rel="stylesheet" type="text/css" href="css/jUi.css" />
	
	<!-- Graph src links -->
	<script src="src/graphcore/aNode.js"></script>
	<script src="src/graphcore/aEdge.js"></script>
	<script src="src/graphcore/aGraph.js"></script>
	<script src="src/graphcore/xNode.js"></script>
	<script src="src/graphcore/xEdge.js"></script>
	<script src="src/graphcore/xGraph.js"></script>
	<!-- DataStructures -->
	<script src="src/datastructures/Queue.js"></script>
	<script src="src/datastructures/PriorityQueue.js"></script>
	<script src="src/datastructures/Matrix.js"></script>
	<!-- Algorithms -->
	<script src="src/algorithms/depthFirstSearch.js"></script>
	<script src="src/algorithms/breadthFirstSearch.js"></script>
	<script src="src/algorithms/dijsktraPQ.js"></script>
	<script src="src/algorithms/BellmanFord.js"></script>
	<script src="src/algorithms/primMST.js"></script>
	<script src="src/algorithms/FloydWarshall.js"></script>
	<!-- Data -->
	<script src="src/data/graph1.js"></script>
	
	<link rel="stylesheet" type="text/css" href="css/demo.css" />

<!-- Script -->
<script id="script" type="text/javascript">

	//-- Global Instances --------------//
		var CNVS, CTX;
		
		function loop(){
			CNVS.loopstep();
			setTimeout(loop);
		};
		
		var holder;
		function loadTest(){
			holder = new vObjBase();
			CNVS.addC(holder);
			loadGraph();
		}
		
		//-- Graph Tests
		var graph;
		var p; var p2;
		function loadGraph(){
			graph = new xGraph();
			holder.addC( graph );
			
			p = new xNode();
			graph.addNode( p );
			
			p2 = new xNode();
			p2.pos( vVec(100,100) );
			graph.addNode( p2 );
			
			graph.linkNodes(p, p2);
		};

		
	$(function(){
		//-- Launch
			launchWickk();
		
		//--set up canvas
			CTX = $('#pad')[0].getContext('2d'); //!-- Should phase this out
			CNVS = new vCanvas();
			CNVS.attachToCanvas($('#pad'));
			CNVS.attachToFps($('#fps'));
			
		//-- Initiate the test
			loadTest();
			
		//-- Kick Off!
			loop();	
	});
	
	//== UI ==================================//
	
		function jsonLoad( json ){
			if(json){
				aSeed.CMN.Registry.clear(); //-- Clear Registry, Not not needed if using clone..
				graph = $a.create(json); 	//-- OR = $a.clone(json);
				holder.addC( graph ); 		//-- Add to the holder
			} else {
				jsonClear();
				graph = new xGraph();
				holder.addC( graph );
			}
		};
		
		function jsonClear(){
			if( graph != null){
				graph.del();
				graph = null;	
			}
		};
		
		$(function(){
			//-- Wire the state triggers
			$('#interact').addClass('on');
			$('#state').children().each(function(){
				$(this).click(function(){
					$('#state').children().removeClass('on');
					$(this).addClass('on');
					graph.editState($(this).attr('id'));
				});
			});
			//-- Wire for JSON
			$('#clear').click(function(){ jsonLoad(); });
			$('#popjsonpretty').click(function(){
				var w = window.open();
				$(w.document.body).html('<pre>'+graph.j('\t')+'</pre>');
			});
			$('#popjson').click(function(e){
				var w = window.open();
				$(w.document.body).html(graph.j());
			});
			$('#loadjson').click(function (){
				var json = $('#jsonEntry').val();
				$('#jsonEntry').val('');//-- Clear the entry because it seems to bog stuff down
				jsonClear();
				jsonLoad(json);
			});
			//-- Wire Inspector
			$('#inspector').click(function(){
				if(!CNVS.inspector.visible){
					CNVS.inspector.show();
					$(this).html('hide');
				}else{
					CNVS.inspector.hide();
					$(this).html('show');
				}
			});

			// Load Temp
			$('#example').click(function(){
				jsonClear();
				jsonLoad( graph1 );
			});

			// WIRE ANALYSIS
			$('#dfs').click(function(){
				depthFirstSearch( graph, graph.focus );
			});
			$('#bfs').click(function(){
				breadthFirstSearch( graph, graph.focus );
			});
			$('#dPQ').click(function(){
				dijsktraPQ( graph, graph.focus, null );
			});
			$('#bf').click(function(){
				bellmanFord( graph, graph.focus );
			});
			$('#mst').click(function(){
				primMST( graph );
			});
			$('#fw').click(function(){
				FloydWarshall( graph );
			});

			$('#set_sink').click(function(){
				if( graph.focus != null )
					graph.s = graph.focus;
			});
			$('#set_target').click(function(){
				if( graph.focus != null )
					graph.t = graph.focus;
			});
			$('#path').click(function(){
				if( graph.t != null && graph.s != null ){
					var path = graph.getPathBetween( graph.s, graph.t );
					$.each( path.nodes, function(k,v){
						$.C( v.a_id );
					});
					$.each( path.edges, function(k,e){
						$.C( e.id() );
						e.color.RGBA(255,255,0,0.75);
					});
				}
			});
			$('#reset_color').click(function(){
				graph.eachEdges( function(i,e){
					e.color.RGBA(50,100,100,0.5);
				});
			});
			
		});
		
</script>

	
</head>

<body>

<!-- UI -->
	<span id="state">
	STATE: 
	<span id="interact">interact</span> |
	<span id="link">link</span> |
	<span id="del">delete</span> |
	</span>
	JSON:
	<span id="clear">empty graph</span> |
	<span id="popjson">pop json</span> |
	<span id="popjsonpretty">pop json pretty</span> |
	<input id="jsonEntry" type="text"> |
	<span id="loadjson">load json</span>  |
	INSPECTOR:
	<span id="inspector">show</span>

	<br>
	<span id="example">ExampleGraph</span> | 
	<span id="dfs">DFS</span> | 
	<span id="bfs">BFS</span> | 
	<span id="dPQ">DijisktraPQ</span> | 
	<span id="bf">BellmanFord</span> |
	<span id="mst">primMST</span> | 
	<span id="fw">FloydWarshall</span> || 
	<span id="set_sink">sink</span> |
	<span id="set_target">target</span> |
	<span id="path">PATH!</span> |
	<span id="reset_color">Reset Color</span>

<!-- Canvas -->
	<div id="fps">fps</div>
	<div id="holder"></div> <!-- Holds the Inspector -->
	<canvas id='pad' width='800' height='600'></canvas>	
	
</body> 
</html> 
